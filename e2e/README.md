# 端到端测试套件

本目录包含本地日志查看工具的端到端测试，覆盖主要用户场景。

## 测试工具

- **Go 测试框架**：使用标准库 `testing` 包
- **HTTP 客户端**：用于 API 测试
- **WebSocket 客户端**：用于实时功能测试
- **文件系统操作**：模拟日志文件变化

## 测试场景

### 1. 基础功能测试
- 服务启动和关闭
- 静态文件服务
- 健康检查端点

### 2. 日志文件管理测试
- 文件列表获取
- 文件内容读取
- 分页功能
- 大文件处理

### 3. 搜索功能测试
- 关键词搜索
- 正则表达式搜索
- 时间范围过滤
- 日志级别过滤

### 4. 实时功能测试
- WebSocket 连接
- 文件变化监控
- 实时更新推送

### 5. 错误处理测试
- 无效请求处理
- 文件不存在处理
- 权限错误处理

## 运行测试

```bash
# 运行所有端到端测试
go test ./e2e/... -v

# 运行特定测试
go test ./e2e/basic_test.go -v
go test ./e2e/search_test.go -v
go test ./e2e/realtime_test.go -v

# 运行性能测试
go test ./e2e/performance_test.go -v -bench=.
```

## 测试数据

测试使用 `testdata/` 目录下的示例日志文件：

- `app.log` - 应用日志
- `error.log` - 错误日志
- `access.log` - 访问日志（Apache 格式）
- `json.log` - JSON 格式日志
- `large.log` - 大文件测试用

## 环境要求

- Go 1.21+
- 可用端口（测试会自动选择）
- 临时文件系统权限